import pytest
from vulnerability_scan import nmap_scan
from tests import setup_test_environment
setup_test_environment()


def test_classify_risk_high():
    port_data = {"script": {"some-vuln-script": "VULNERABLE"}}
    assert nmap_scan.classify_risk(port_data) == "[HIGH]"

def test_classify_risk_medium():
    port_data = {"name": "http"}
    assert nmap_scan.classify_risk(port_data) == "[MEDIUM]"

def test_classify_risk_low():
    port_data = {"name": "randomservice"}
    assert nmap_scan.classify_risk(port_data) == "[LOW]"
